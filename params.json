{
  "name": "Fluseq",
  "tagline": "A bioinformatics pipeline for influenza virus genome sequencing that includes contig assembly, blastn, filter for in-run, between-sample contamination reads, and consensus sequence calling.",
  "body": "# FluSeq-v1.0\r\n\r\nVersion 1.0 for Illumina Miseq system.\r\nFor Research Use only. Not for use in diagnostic procedures.\r\n\r\nFluSeq is a bioinformatics program developed and tested for an influenza A genome-wide amplicon-based high-throughput sequencing (HTS) method, using Illumina Miseq system [1]. It includes contigs assembly, blastn, filters for in-run contamination reads, and consensus sequence calling. Users are advised to refer the end-to-end laboratory protocol described by Lee, et al. 2016 [1]. Users are encouraged to modify the FluSeq program written in python scripts for other clinical virus amplicon-based HTS methods.\r\n\r\n## INSTALLATION\r\n\r\nInstallation instructions are available for LINUX/UNIX or MacOSX only. The entire analytic workflow was implemented and tested by the author on CentOS-6.6/RedHat Linux and MacOSX, but not on other operating systems. The operating system should contain the latest version of java.\r\n\t\r\n### Install Python 3.4.3 and pip \r\n(https://www.python.org/downloads/)\r\n- Upon installation, log in as root from Terminal (Linux and MacOSX): \r\n```\r\n# pip3.4 install pandas\r\n# pip3.4 install numpy\r\n# pip3.4 install ZODB\r\n# pip3.4 install lxml \r\n# pip3.4 install xlrd\r\n# pip3.4 install xlwt\r\n# pip3.4 install beautifulsoup4\r\n# pip3.4 install scipy (# yum install lapack-devel if lapack/blas resources not found in the system)\r\n# pip3.4 install transaction\r\n```\r\n\r\n###\tInstall VICUNA-v1.3 \r\n(http://www.broadinstitute.org/scientific-community/science/projects/viral-genomics/vicuna) \r\n- The vicuna_config.txt used by this analytic workflow is stored in FluSeq Folder. Compilation of vicunAnalysis is not required during the installation. \r\n- Path to the compiled vicuna executive file needs to be changed accordingly in the FluSeq-v1.0.py, i.e. Line 100: First argument of the  subprocess.Popen, to “YourPathInstalled/VICUNA_v1.3/bin/vicuna-omp-v1.0”\r\n- Optional: Line 104 - logging.info: Change program path to “YourPathInstalled/VICUNA_v1.3/bin/vicuna-omp-v1.0”.\r\n\r\n### Install BLAST 2.2.31+ software \r\n(https://blast.ncbi.nlm.nih.gov/Blast.cgi?PAGE_TYPE=BlastDocs&DOC_TYPE=Download)\r\n\r\n### Install BWA-0.6.2 software \r\n(http://sourceforge.net/projects/bio-bwa/files/)\r\n- Users are advised to install BWA-0.6.2 software but not any version after this, as bwa-aln/sampe in this version was found to be more stable in reads alignment for this study.\r\n\r\n### Install samtools-1.2 \r\n(http://sourceforge.net/projects/samtools/files/samtools/1.2/)\r\n\r\n### Install GATK-3.4-46 software\r\n(https://www.broadinstitute.org/gatk/download/)\r\n- Path to the GenomeAnalysisTK.jar executive file needs to be changed accordingly in the FluSeq-v1.0.py, i.e. Lines 233, 259,  and 269: Third or Fourth argument of the  subprocess.Popen, to “YourPathInstalled/GenomeAnalysisTK.jar”.\r\n- Optional: Lines 243, 265,  and 278: logging.info: Change program path to “YourPathInstalled/GenomeAnalysisTK.jar”.\r\n\r\n### Install picard-tools-1.138 \r\n(https://github.com/broadinstitute/picard/releases/tag/1.138)\r\n- Path to the GenomeAnalysisTK.jar executive file needs to be changed accordingly in the FluSeq-v1.0.py, i.e. Line 146: Third argument of the  subprocess.Popen, to “YourPathInstalled/picard-tools-1.138/picard.jar”.\r\n- Optional: Line 152: logging.info: Change program path to “YourPathInstalled/picard-tools-1.138/picard.jar”.\r\n\r\n### Install FluSeq\r\na.\tDownload the FluSeq.tar, decompress, and mv the FluSeq Folder to ~.\r\n```\r\n$ tar –xvf FluSeq.tar\r\n$ mv FluSeq ~ \r\n```\r\nb.\tChange working directory to FluSeq \r\n```\r\n$ cd ~/FluSeq\r\n```\t\r\n\r\n## USAGE\r\n\r\n### Influenza Sequence Database \r\nThis section describes the sequence database used for blastn. It contains all influenza sequences available in GenBank, updated to the date accessed by the user.\r\n\r\n#### Creating/Updating Sequence Database\t\r\n1.\tDownload all influenza sequences available from NCBI Influenza Virus Resource with a customized FASTA defline as “>{accession}|{strain}|{segment}|{serotype}” and save the fasta file as FASTA.fa in FASTADatabase directory.\r\n2.\tChange working directory to FASTADatabase\r\n```\r\n$ cd ~/FluSeq/FASTADatabase\r\n```\r\n3.\tExecute DBupdate\r\n```\r\n$ ./DBupdate.py FASTA.fa\r\nor\r\n$ python3 DBupdate.py FASTA.fa\r\nor\r\n$ python3.4 DBupdate.py FASTA.fa\r\n```\r\n\r\n### FluSeq INPUT FILES and FOLDER\r\nThis section describes the input FluSeq-v1.0 requires.\r\n\r\n#### Folder and File Naming\r\nThe top-level input folder can be named in any combination of alphanumeric characters. It is advisable that the first letter of the name of a folder is in upper case for a better folder and file organization, e.g. Folder20151231 (**Figure 1** – Folder in red).\r\n\r\nThe input folder should contain paired-end reads in fastq.gz format generated by Miseq Reporter or fastq2bcl2, e.g. SampleID_L001_R1_001.fastq.gz and SampleID_L001_R2_001.fastq.gz (**Figure 1**). Also, it should contain the ResequencingRunStatistics.xml that can be copied from the top-level run folder named according to Miseq <ExperimentName>, e.g. YYMMDD_machinename_experimentnumber_flowcellnumber.\r\n\r\n![Figure 1](https://cloud.githubusercontent.com/assets/13162113/13169042/5dc99350-d71d-11e5-9561-8402acce20e0.png)\r\n\r\n**Figure 1.** Directory of FluSeq and input folder. Input folders for run analysis and contamination learning are colored in red and orange, respectively.\r\n\r\n### Contamination Learning (Optional)\r\n\r\nThe current FluSeq software provides the database file for MS2 contamination statistics (i.e. ms2SysCtrl.db). However, it is recommeded that individual laboratories generate a laboratory-specific database file to allow more accurate statistics. \r\n\r\nThe input folder for in-run contamination learning should contain paired-end reads for an in-run negative system control (NSC) in fastq.gz format generated by Miseq Reporter or fastq2bcl2, e.g. SampleID_L001_R1_001.fastq.gz and SampleID_L001_R2_001.fastq.gz (**Figure 1** – Folder in orange). Also, it should contain the ResequencingRunStatistics.xml that can be copied from the top-level run folder named according to Miseq <ExperimentName>, e.g. YYMMDD_machinename_experimentnumber_flowcellnumber. \r\n\r\nThe database will be updated according for each execution. A new database file will be generated if the ms2SysCtrl.db file is not found in the FluSeq folder.\r\n\r\n#### Procedure\r\n1.\tChange working directory to FluSeq \r\n```\r\n$ cd ~/FluSeq\r\n```\r\n2.\tExecute FluSeq\r\n```\r\n$ ./ms2ContLearning.py InputFolder 151206\r\nor\r\n$ python3 ms2ContLearning.py InputFolder 151206\r\nor\r\n$ python3.4 ms2ContLearning.py InputFolder 151206\r\n```\r\n\r\n### Execution of FluSeq analysis\r\na.\tChange working directory to FluSeq \r\n```\r\n$ cd ~/FluSeq\r\n```\r\nb.\tExecute FluSeq\r\n```\r\n$ ./FluSeq-v1.0.py InputFolder\r\nor\r\n$ python3 FluSeq-v1.0.py InputFolder\r\nor\r\n$ python3.4 FluSeq-v1.0.py InputFolder\r\n```\r\n\r\n\r\n## REFERENCE:\r\n\r\n[1] Hong Kai Lee, Chun Kiat Lee, Julian Wei-Tze Tang, Tze Ping Loh, and Evelyn Siew-Chuan Koay. Contamination-controlled high-throughput whole genome sequencing for influenza A viruses using the MiSeq sequencer. *Sci Rep.* 2016, 6:33318. doi: 10.1038/srep33318.\r\n\r\n",
  "google": "UA-71299750-2",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}